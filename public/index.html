<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8" />
  <title>Alfred, el Mayordomo</title>
  <style>
    body {
      font-family: 'Georgia', serif;
      background: #111;
      color: #eee;
      padding: 20px;
    }
    #chat {
      max-width: 600px;
      margin: auto;
      background: #222;
      padding: 20px;
      border-radius: 12px;
    }
    input, button {
      width: 100%;
      padding: 12px;
      margin-top: 10px;
      border-radius: 8px;
      border: none;
    }
    #messages {
      white-space: pre-wrap;
      margin-top: 20px;
      font-size: 16px;
    }
    .msg {
      margin-bottom: 10px;
    }
  </style>
</head>
<body>
  <div id="chat">
    <h2>ğŸ•µï¸ Alfred, el Mayordomo</h2>
    <div id="messages">
      <div class="msg">ğŸ•¯ï¸ <strong>Bienvenido, joven heredero(a)</strong>. Estoy aquÃ­ para asistirle en la preparaciÃ³n de su personaje teatral. Â¿PodrÃ­a indicarme su nombre completo?</div>
    </div>
    <input id="userInput" placeholder="Escriba su respuesta..." />
    <button onclick="sendMessage()">Enviar</button>
  </div>

  <script>
    const messages = [
      {
        role: "system",
        content: `ActÃºa como Alfred, un mayordomo elegante y misterioso del Detective Club ğŸ•µï¸â€â™‚ï¸. Tu misiÃ³n es recopilar con amabilidad y precisiÃ³n los datos necesarios para preparar el reparto de personajes. Usa siempre un tono formal, elegante y teatral. Haz las siguientes preguntas una por una y recopila las respuestas:

1. ğŸ­ Â¿CuÃ¡l es su nombre completo, noble invitado?
2. ğŸ“§ Â¿PodrÃ­a indicarme su direcciÃ³n de correo electrÃ³nico?
3. ğŸ‚ Â¿CuÃ¡l es su edad aproximada?
4. âš§ï¸ Â¿CuÃ¡l es su gÃ©nero? (ğŸ™‹â€â™€ï¸ Femenino / ğŸ‘¨ğŸ»â€ğŸ”§ Masculino / ğŸŒ€ Otro o prefiero no decirlo)
5. ğŸ¬ Â¿CuÃ¡l es su nivel de motivaciÃ³n teatral y extroversiÃ³n?
   A. ğŸ”¥ WHOOHOO HE NACIDO PARA ESTO ğŸ¤˜ğŸ»
   B. ğŸ¤© Â¡ME ENCANTA LA IDEA DE ACTUAR!
   C. ğŸ‘‘ Â¡LO QUE VENGA LO AFRONTARÃ‰!
   D. ğŸ™ˆ Â¡SOY TÃMID@ Y DIVERTID@!
   E. ğŸ¤« Â¡ALGO INCREÃBLEMENTE DISCRETO, POR FAVOR!
6. ğŸ—“ï¸ Â¿En quÃ© fecha y hora participarÃ¡ en la sesiÃ³n?

Una vez recogidos todos los datos, muÃ©stralos en un JSON limpio y termina con esta frase:
â€œğŸ© Gracias, joven heredero(a). Su informaciÃ³n ha sido recogida con toda la discreciÃ³n y elegancia del Detective Club. El equipo organizador tomarÃ¡ nota. Que la intriga le acompaÃ±e siempre. ğŸ•¯ï¸ğŸ•µï¸â€â™‚ï¸â€
Luego, no debes responder nada mÃ¡s.`
      },
      {
        role: "assistant",
        content: "ğŸ•¯ï¸ Bienvenido, joven heredero(a). Estoy aquÃ­ para asistirle en la preparaciÃ³n de su personaje teatral. Â¿PodrÃ­a indicarme su nombre completo?"
      }
    ];

    async function sendMessage() {
      const input = document.getElementById("userInput");
      const userMessage = input.value;
      if (!userMessage) return;

      messages.push({ role: "user", content: userMessage });

      document.getElementById("messages").innerHTML += `<div class="msg">ğŸ—£ï¸ <strong>TÃº:</strong> ${userMessage}</div>`;
      input.value = "...";

      const response = await fetch("/api/alfred", {
        method: "POST",
        headers: {
          "Content-Type": "application/json"
        },
        body: JSON.stringify({ messages })
      });

      const data = await response.json();
      const reply = data.choices[0].message.content;
      messages.push({ role: "assistant", content: reply });
      document.getElementById("messages").innerHTML += `<div class="msg">ğŸ© <strong>Alfred:</strong> ${reply}</div>`;
      input.value = "";
    }
  </script>
</body>
</html>